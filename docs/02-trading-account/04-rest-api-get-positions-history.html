<h3 id="trading-account-rest-api-get-positions-history">Get positions history</h3>
<p>Retrieve the updated position data for the last 3 months. Return in reverse chronological order using utime. Getting positions history is supported under Portfolio margin mode since <strong>04:00 AM (UTC) on November 11, 2024</strong>.</p>
<h4 id="trading-account-rest-api-get-positions-history-rate-limit-10-requests-per-2-seconds">Rate Limit: 10 requests per 2 seconds</h4><h4 id="trading-account-rest-api-get-positions-history-rate-limit-rule-user-id">Rate limit rule: User ID</h4><h4 id="trading-account-rest-api-get-positions-history-permission-read">Permission: Read</h4><h4 id="trading-account-rest-api-get-positions-history-http-request">HTTP Request</h4>
<p><code>GET /api/v5/account/positions-history</code></p>
<blockquote>
<p>Request Example</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>GET /api/v5/account/positions-history
</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">okx.Account</span> <span class="k">as</span> <span class="n">Account</span>

<span class="c1"># API initialization
</span><span class="n">apikey</span> <span class="o">=</span> <span class="s">"YOUR_API_KEY"</span>
<span class="n">secretkey</span> <span class="o">=</span> <span class="s">"YOUR_SECRET_KEY"</span>
<span class="n">passphrase</span> <span class="o">=</span> <span class="s">"YOUR_PASSPHRASE"</span>

<span class="n">flag</span> <span class="o">=</span> <span class="s">"1"</span>  <span class="c1"># Production trading:0 , demo trading:1
</span>
<span class="n">accountAPI</span> <span class="o">=</span> <span class="n">Account</span><span class="p">.</span><span class="n">AccountAPI</span><span class="p">(</span><span class="n">apikey</span><span class="p">,</span> <span class="n">secretkey</span><span class="p">,</span> <span class="n">passphrase</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span>

<span class="c1"># Get positions history
</span><span class="n">result</span> <span class="o">=</span> <span class="n">accountAPI</span><span class="p">.</span><span class="n">get_positions_history</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div><h4 id="trading-account-rest-api-get-positions-history-request-parameters">Request Parameters</h4>
<table><thead>
<tr>
<th style="text-align: left">Parameter</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Required</th>
<th style="text-align: left">Description</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: left">instType</td>
<td style="text-align: left">String</td>
<td style="text-align: left">No</td>
<td style="text-align: left">Instrument type<br/><code>MARGIN</code><br/><code>SWAP</code><br/><code>FUTURES</code><br/><code>OPTION</code></td>
</tr>
<tr>
<td style="text-align: left">instId</td>
<td style="text-align: left">String</td>
<td style="text-align: left">No</td>
<td style="text-align: left">Instrument ID, e.g. <code>BTC-USD-SWAP</code></td>
</tr>
<tr>
<td style="text-align: left">mgnMode</td>
<td style="text-align: left">String</td>
<td style="text-align: left">No</td>
<td style="text-align: left">Margin mode<br/><code>cross</code> <code>isolated</code></td>
</tr>
<tr>
<td style="text-align: left">type</td>
<td style="text-align: left">String</td>
<td style="text-align: left">No</td>
<td style="text-align: left">The type of latest close position<br/><code>1</code>: Close position partially;<code>2</code>：Close all;<code>3</code>：Liquidation;<code>4</code>：Partial liquidation; <code>5</code>：ADL; <br/>It is the latest type if there are several types for the same position.</td>
</tr>
<tr>
<td style="text-align: left">posId</td>
<td style="text-align: left">String</td>
<td style="text-align: left">No</td>
<td style="text-align: left">Position ID. There is attribute expiration. The posId will be expired if it is more than 30 days after the last full close position, then position will use new posId.</td>
</tr>
<tr>
<td style="text-align: left">after</td>
<td style="text-align: left">String</td>
<td style="text-align: left">No</td>
<td style="text-align: left">Pagination of data to return records earlier than the requested <code>uTime</code>, Unix timestamp format in milliseconds, e.g. <code>1597026383085</code></td>
</tr>
<tr>
<td style="text-align: left">before</td>
<td style="text-align: left">String</td>
<td style="text-align: left">No</td>
<td style="text-align: left">Pagination of data to return records newer than the requested <code>uTime</code>, Unix timestamp format in milliseconds, e.g. <code>1597026383085</code></td>
</tr>
<tr>
<td style="text-align: left">limit</td>
<td style="text-align: left">String</td>
<td style="text-align: left">No</td>
<td style="text-align: left">Number of results per request. The maximum is 100. The default is 100. All records that have the same <code>uTime</code> will be returned at the current request</td>
</tr>
</tbody></table>
<blockquote>
<p>Response Example</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"cTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1654177169995"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"ccy"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"closeAvgPx"</span><span class="p">:</span><span class="w"> </span><span class="s2">"29786.5999999789081085"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"closeTotalPos"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"instId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC-USD-SWAP"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"instType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SWAP"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"lever"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10.0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"mgnMode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cross"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"openAvgPx"</span><span class="p">:</span><span class="w"> </span><span class="s2">"29783.8999999995535393"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"openMaxPos"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"realizedPnl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.001"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"fee"</span><span class="p">:</span><span class="w"> </span><span class="s2">"-0.0001"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"fundingFee"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"liqPenalty"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pnl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.0011"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pnlRatio"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.000906447858888"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"posId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"452587086133239818"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"posSide"</span><span class="p">:</span><span class="w"> </span><span class="s2">"long"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"direction"</span><span class="p">:</span><span class="w"> </span><span class="s2">"long"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"triggerPx"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"uTime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1654177174419"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"uly"</span><span class="p">:</span><span class="w"> </span><span class="s2">"BTC-USD"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"nonSettleAvgPx"</span><span class="p">:</span><span class="s2">""</span><span class="p">,</span><span class="w">
            </span><span class="nl">"settledPnl"</span><span class="p">:</span><span class="s2">""</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"msg"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h4 id="trading-account-rest-api-get-positions-history-response-parameters">Response Parameters</h4>
<table><thead>
<tr>
<th style="text-align: left">Parameter</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: left">instType</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Instrument type</td>
</tr>
<tr>
<td style="text-align: left">instId</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Instrument ID</td>
</tr>
<tr>
<td style="text-align: left">mgnMode</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Margin mode<br/><code>cross</code> <code>isolated</code></td>
</tr>
<tr>
<td style="text-align: left">type</td>
<td style="text-align: left">String</td>
<td style="text-align: left">The type of latest close position<br/><code>1</code>：Close position partially;<code>2</code>：Close all;<code>3</code>：Liquidation;<code>4</code>：Partial liquidation; <code>5</code>：ADL; <br/>It is the latest type if there are several types for the same position.</td>
</tr>
<tr>
<td style="text-align: left">cTime</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Created time of position</td>
</tr>
<tr>
<td style="text-align: left">uTime</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Updated time of position</td>
</tr>
<tr>
<td style="text-align: left">openAvgPx</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Average price of opening position<br/>Under cross-margin mode, the entry price of expiry futures will update at settlement to the last settlement price, and when the position is opened or increased.</td>
</tr>
<tr>
<td style="text-align: left">nonSettleAvgPx</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Non-settlement entry price<br/>The non-settlement entry price only reflects the average price at which the position is opened or increased.<br/>Only applicable to <code>cross</code> <code>FUTURES</code></td>
</tr>
<tr>
<td style="text-align: left">closeAvgPx</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Average price of closing position</td>
</tr>
<tr>
<td style="text-align: left">posId</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Position ID</td>
</tr>
<tr>
<td style="text-align: left">openMaxPos</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Max quantity of position</td>
</tr>
<tr>
<td style="text-align: left">closeTotalPos</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Position's cumulative closed volume</td>
</tr>
<tr>
<td style="text-align: left">realizedPnl</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Realized profit and loss<br/>Only applicable to <code>FUTURES</code>/<code>SWAP</code>/<code>OPTION</code><br/><code>realizedPnl</code>=<code>pnl</code>+<code>fee</code>+<code>fundingFee</code>+<code>liqPenalty</code>+<code>settledPnl</code></td>
</tr>
<tr>
<td style="text-align: left">settledPnl</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Accumulated settled profit and loss (calculated by settlement price)<br/>Only applicable to <code>cross</code> <code>FUTURES</code></td>
</tr>
<tr>
<td style="text-align: left">pnlRatio</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Realized P&amp;L ratio</td>
</tr>
<tr>
<td style="text-align: left">fee</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Accumulated fee<br/>Negative number represents the user transaction fee charged by the platform.Positive number represents rebate.</td>
</tr>
<tr>
<td style="text-align: left">fundingFee</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Accumulated funding fee</td>
</tr>
<tr>
<td style="text-align: left">liqPenalty</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Accumulated liquidation penalty. It is negative when there is a value.</td>
</tr>
<tr>
<td style="text-align: left">pnl</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Profit and loss (excluding the fee).</td>
</tr>
<tr>
<td style="text-align: left">posSide</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Position mode side<br/> <code>long</code>: Hedge mode long<br/> <code>short</code>: Hedge mode short<br/> <code>net</code>: Net mode</td>
</tr>
<tr>
<td style="text-align: left">lever</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Leverage</td>
</tr>
<tr>
<td style="text-align: left">direction</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Direction: <code>long</code> <code>short</code><br/>Only applicable to <code>MARGIN/FUTURES/SWAP/OPTION</code></td>
</tr>
<tr>
<td style="text-align: left">triggerPx</td>
<td style="text-align: left">String</td>
<td style="text-align: left">trigger mark price. There is value when <code>type</code> is equal to <code>3</code>, <code>4</code> or <code>5</code>. It is "" when <code>type</code> is equal to <code>1</code> or <code>2</code></td>
</tr>
<tr>
<td style="text-align: left">uly</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Underlying</td>
</tr>
<tr>
<td style="text-align: left">ccy</td>
<td style="text-align: left">String</td>
<td style="text-align: left">Currency used for margin</td>
</tr>
</tbody></table>
